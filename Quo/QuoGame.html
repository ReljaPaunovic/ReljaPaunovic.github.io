<!DOCTYPE html>
<html>
<head>
<title>Quo JS Game</title>
<script type="text/javascript" src="https://cdn.jsdelivr.net/quojs/2.3.1/quo.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<div id="myElement"></div>
<!-- <div id="console" class="console"></div> -->

<style>
#myElement {
    height: 70px;
    width: 70px;
    position: absolute;
    background: #eee;
    border-radius: 2px;
    box-shadow: 0 0 2px rgba(0,0,0,0.2);
}

.console {
    border-left: 1px solid #eee;
    width: 50%;
    font: 11px "Lucida Console", Monaco, monospace;
    position: absolute;
    right: 0;
    top: 0;
    bottom: 0;
    overflow: scroll;
}
body {
  margin: 0;
}
p {
  position: absolute;
}
  </style>
</head>

<body>

<p id = "12">asdf</p>

<canvas width="616" height="556" id="mazecanvas">Can't load the maze game, because your browser doesn't support HTML5.</canvas>

<script>
    document.getElementById("mazecanvas").setAttribute("width", window.innerWidth);
    document.getElementById("mazecanvas").setAttribute("height", window.innerHeight);
    var a = document.getElementById("12");
    var canvas = document.getElementById("mazecanvas");
    var context = canvas.getContext("2d");
    var mazeWidth = 556;
    var mazeHeight = 556;
    var intervalVar;
    function drawMaze() {
        makeWhite(0, 0, canvas.width, canvas.height);
        var mazeImg = new Image();
        mazeImg.onload = function () { // when the image is loaded, draw the image, the rectangle and the circle
            context.drawImage(mazeImg, 0, 0);
            context.beginPath();
            context.arc(542, 122, 7, 0, 2 * Math.PI, false);
            context.closePath();
            context.fillStyle = '#00FF00';
            context.fill();
          };
        mazeImg.src = "simplemaze.gif";
      }

    drawMaze();

    function makeWhite(x, y, w, h) {
        context.beginPath();
        context.rect(x, y, w, h);
        context.closePath();
        context.fillStyle = "white";
        context.fill();
    }

    var $myCanvas = $$('#mazecanvas');
    var $myElement = $$('#myElement');
    var myElementHeight = $myElement.height();
    var myElementWidth = $myElement.width();

    var initialPosition = {'left' : 80, 'top' : 100};
    $('#myElement').css({
      'left' : initialPosition.left + 'px', 'top' : initialPosition.top + 'px'
    });
    var deltaX = 0;
    var deltaY = 0;
    var cumulativeDeltaPosition = {'left' : initialPosition.left, 'top' : initialPosition.top};
    var firstTimeSwipe = true;
    $myCanvas.swiping(function(e){
        if(firstTimeSwipe){
          //swipe start
          //$('#myElement').css({
          //  'top' : cumulativeDeltaPosition.top + 'px', 'left' : cumulativeDeltaPosition.left + 'px'
          //});
          firstTimeSwipe = false;
        }
        else{
          //console.log(e.quoData.delta.x);
          deltaX = e.currentTouch.x - e.iniTouch.x;// - myElementWidth / 2;
          deltaY = e.currentTouch.y - e.iniTouch.y;// - myElementHeight / 2;
          //a.textContent = "x =" + x +" y ="+ y;
          //$myElement.vendor('transform', 'translate(' + x +'px,'+ y +'px)'); // original one
          var top = parseFloat($('#myElement').css('top'));
          var left = parseFloat($('#myElement').css('left'));
          a.textContent = "top : " + top + "left : " + left;
          $('#myElement').css({
            'top' : cumulativeDeltaPosition.top + deltaY + 'px', 'left' : cumulativeDeltaPosition.left + deltaX + 'px'
          });
        }
    });
    //Triggers at end of swipe
    $myCanvas.swipe(function(e){
      //console.log("omg");
      cumulativeDeltaPosition.left += deltaX;
      cumulativeDeltaPosition.top += deltaY;
      firstTimeSwipe = true;
    });


      function getMethods(obj)
      {
          var res = [];
          for(var m in obj) {
              if(typeof obj[m] == "function") {
                  res.push(m)
              }
          }
          return res;
      }


    $myCanvas.pinching(function(e){
      //PINCHING MA MAN PINCHING, non of the below worked
      //$myElement.vendor('transform', 'scale('+e.scale+')');
      //$myElement.vendor('transform', 'scale('+e.scale+','+e.scale+')');
      a.textContent = getMethods(e).toString();
      $myElement.css({
        'transform': 'scale('+e.scale+','+e.scale+')'
      });

      //a.textContent = "This summer's gonna hurt like a motherfucker";

    });


</script>
</body>

</html>
